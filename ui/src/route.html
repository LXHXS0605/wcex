<!-- 
    根据路由级别判断
    如有包名则设置为包名路由
    否则设置为当前包名组件
 -->

<template name="default" home="">
  <meta name="scope" />
  <style>
    :host {
      display: block;
    }
  </style>
  <div id="route" $as="component"></div>
  <script scope=".">
    return class {
      component = this.home;
      changeRouter() {
        var r = this.$router.route[this.name];
        var rel = this.$id.route;
        var rsc = this.$id.route.$scope;
        if (rel) {
          // 首先设置属性
          for (var k of Object.keys(r.attrs)) {
            let v = r.attrs[k];
            this.$id.route.setAttribute(k, v);
            if (rsc && rsc.hasOwnProperty(k)) rsc[k] = v;
          }
          // 更新标签
          this.component = r.tag;
        } else {
          this.$log.error("invalid route name:", this.name);
        }
      }
      onReady() {
        window.addEventListener("route-change", this.changeRouter.bind(this));
        this.changeRouter();
      }
    };
  </script>
</template>
