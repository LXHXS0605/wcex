<!-- 
    水平导航菜单,支持下拉二级菜单
    通过配置json创建导航菜单

    @prop data, 多级 item 数组, 格式如下:
    [
        {
            text: "菜单项1",
            icon: "mdi:home", // 字符或者icon对象, 参考icon组件
            href: "/home",
            children: [
                {
                    text: "子菜单项1",
                    icon: "mdi:home",
                    href: "/home",
                },
                {
                    text: "子菜单项2",
                    icon: "mdi:home",
                    href: "/home",
                },
            ],
        },
        {
            text: "菜单项2",
            icon: "mdi:home",
            href: "/home",路由 
        },
    ]
-->
<template $data="[]" nav-width.float="6" $color="$color.pri" $text-color="$color.textr.l3">
	<style>
		:host {
			display: flex;
			gap: 1em;
			overflow-x: auto;
		}

		.item {
			display: flex;
			flex-direction: column;
			align-items: center;
			padding: 0.1em 0.3em 0em 0.3em;
			user-select: none;
			border-bottom: 2px solid transparent;
			transition: all 0.3s;
			min-width: 0;
			color: "$textColor";
            position: relative;
		}

		.item:focus {
			color: "$textColor.l5_";
			padding: 0.1em 1em 0em 1em;
			border-bottom: 2px solid "$$color.pri.l3_";
			outline: none;
		}

		.item > .icon {
			--icon-color: "$textColor";
			transition: all 0.3s;
		}

		.item:focus > .icon {
			--icon-color: "$textColor.l5_";
		}

		.text {
			white-space: nowrap;
			font-size: 0.8em;
			margin: 0 0.5em 0 0.5em;
		}

        .pop{
            position: absolute;
            overflow: hidden;
            width: 1px;
            height: 100%;
            top: 0;
            left: 0;
        }

		.child {
			display: flex;
			position: absolute;
			background-color: "$color.a2_.l4";
			top: calc(100% + 4px);
			left: 0;
			flex-direction: column;
			padding: 0.5em 0 0.5em 0;
			gap: 0.2em;
			box-sizing: border-box;
			transition: all 0.3s;
			opacity: 0;
			visibility: hidden;
			border-radius: 0 0 0.5em 0.5em;
			min-width: 6em;

			/* overflow: ; */
			z-index: 99;
		}

		.item:focus >.pop> .child {
			visibility: visible;
			color: "$textColor.l5_";
			opacity: 1;
		}

		.subitem {
			display: flex;
			padding: 0.2em 0;
			position: relative;
			align-items: center;
			user-select: none;
			transition: all 0.3s;
			border-left: 0em solid "$color";
			color: "$textColor";
		}

		.subitem:hover {
			color: "$textColor.l5_";
			border-left: 0.5em solid "$color.l5_";
			background-color: "$color";
		}

		.subitem > .icon {
			margin-left: 0.5em;
			--icon-color: "$textColor";
		}

		.subitem:hover > .icon {
			--icon-color: "$textColor.l5_";
		}
		.subitem[is-line] {
			pointer-events: none;
		}
		.line {
			width: 100%;
			height: 1px;
			background-color: "$color.l5_";
		}
	</style>

	<div
		$for(v,k)="data"
		class="item"
		tabindex="0"
		@click.stop="v.href && $router.go(v.href); "
		@mouseenter="$el.focus()"
		@mouseleave="$el.blur()"
	>
		<!-- 图标 -->
		<wcex-ui.icon
			$if="v.icon"
			$icon="v.icon.icon||v.icon"
			$pkg="v.icon.pkg||'mdi'"
			$type="v.icon.type||'outlined'"
			size="1.8"
			class="icon"
			$color="$color.text"
		></wcex-ui.icon>
		<!-- 文字 -->
		<div class="text" $>v.text</div>

		<!-- 子菜单 -->
        <div class="pop">

		<div class="child shadow" $if="v.children">
			<div class="subitem" tabindex="0" $is-line="v1.text.length==0" $for(v1,k1)="v.children" @click.stop="v1.href && $router.go(v1.href)">
				<wcex-ui.icon
					$if="v1.icon"
					$icon="v1.icon.icon||v1.icon"
					$pkg="v1.icon.pkg||'mdi'"
					$type="v1.icon.type||'outlined'"
					class="icon"
					$color="$color.text"
				></wcex-ui.icon>
				<div class="text" style="margin-left: 0.5em" $if="v1.text.length>0" $>v1.text</div>
				<div class="line" $if="v1.text.length==0"></div>
			</div>
		</div>
    </div>

	</div>

	<script scope=".">
		return class {};
	</script>
</template>
