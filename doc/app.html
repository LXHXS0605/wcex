<template>
  <link rel="stylesheet" href="." global="import" />

  <meta name="scope" shadow.int="1" drawer.bool="true" />
  <style>
    :host {
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    .main {
      display: flex;
      flex: 1;
    }
    .left {
      overflow-x: hidden;
      overflow-y: auto;
      background-color: "$$color.pria.l3_";
    }
    .content {
      position: relative;
      flex: 1;
      overflow-x: hidden;
      overflow-y: auto;
    }
  </style>

  <!-- 标题栏 -->
  <wcex-ui.title class="shadow" style="z-index: 999;padding: 0.5em 0.5em;" $color="$color.pri.l2">
    <!-- 标题栏图标区 -->
    <div slot="icon" class="row">
      <wcex-ui.icon
        icon="menu"
        size="3"
        active
        $color="$color.pri.l3_"
        @click.stop="drawer=!drawer"
        :style="transform: rotate(${drawer?0:90}deg);"
      ></wcex-ui.icon>
      <img src="./assets/logo.png" style="width: 3em; margin: 0 1em" alt="" />
    </div>
    <!-- 标题内容区 -->
    <h2>WCEX</h2>
    <div slot="subtitle">原生响应式 Web Components 扩展库</div>

    <!-- 工具区 -->
    <div class="column" slot="end" style="width: 6em" :>
      <div class="column" style="justify-content: center">
        <!-- 调色板 -->
        <com-color_picker> </com-color_picker>
        <div style="text-align: center;" :>${loadtime}ms</div>
      </div>
    </div>
  </wcex-ui.title>
  <!-- 主窗口 -->
  <div class="main">
    <!-- 菜单 -->
    <div class="left shadow">
      <nav- $min="!drawer"></nav->
    </div>
    <div class="content">
      <main-  class="main"></main->

      <footer-></footer->
    </div>
  </div>

  <script scope=".">

    return class {
      loadtime = 0;
      // 动态设置字体
      onCreate() {
        window.addEventListener("wcex-loaded", (ev) => {
          this.loadtime = ev.detail.time;
        });
        this.loadFont();
      }
      loadFont() {
        // cn: { css: "@/@wc1font/honglei-sim/font.css", family: "honglei sim" },
        // https://cdn.jsdelivr.net/npm/@wc1font/lxgw-wen-kai-screen/font.css
        var font = {
          cn: { css: "@/@wc1font/lxgw-wen-kai-screen/font.css", family: "LXGW WenKai Screen" },
          en: { css: "@/@fontsource/concert-one/index.min.css", family: "Concert One" },
        };

        if (localStorage.__FONT) {
          try {
            font = JSON.parse(localStorage.__FONT);
          } catch (e) {
            this.$log("invalid font config:", e.message);
          }
        }

        var family = "Roboto, Arial, Helvetica, sans-serif";
        Object.values(font).forEach((v) => {
          var link = document.createElement("link");
          link.rel = "stylesheet";
          link.href = this.$path(v.css);
          document.head.appendChild(link);
          family = v.family + ", " + family;
        });
        document.body.parentElement.style.fontFamily = family;
      }
    };
  </script>
</template>
